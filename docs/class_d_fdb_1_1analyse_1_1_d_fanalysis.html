<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DFdb Documentation: DFdb.analyse.DFanalysis Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DFdb Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('class_d_fdb_1_1analyse_1_1_d_fanalysis.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="class_d_fdb_1_1analyse_1_1_d_fanalysis-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">DFdb.analyse.DFanalysis Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Handles analysis and plotting of comparative results.  
 <a href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for DFdb.analyse.DFanalysis:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_d_fdb_1_1analyse_1_1_d_fanalysis__coll__graph.png" border="0" usemap="#a_d_fdb_8analyse_8_d_fanalysis_coll__map" alt="Collaboration graph"/></div>
<map name="a_d_fdb_8analyse_8_d_fanalysis_coll__map" id="a_d_fdb_8analyse_8_d_fanalysis_coll__map">
<area shape="rect" title="Handles analysis and plotting of comparative results." alt="" coords="5,5,208,200"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab31c59b13440f2e7f87ea89c54585741"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#ab31c59b13440f2e7f87ea89c54585741">__init__</a> (self, <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a1abf06bd44f595f62f28a946547157b0">skl_kde_samples</a>=10000)</td></tr>
<tr class="memdesc:ab31c59b13440f2e7f87ea89c54585741"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html" title="Handles analysis and plotting of comparative results.">DFanalysis</a> object.  <a href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#ab31c59b13440f2e7f87ea89c54585741">More...</a><br /></td></tr>
<tr class="separator:ab31c59b13440f2e7f87ea89c54585741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2193b9959e668738e07d9a011e410c8b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a2193b9959e668738e07d9a011e410c8b">plot_position_difference</a> (self, reference, comparisons, ignore_H=False, plot_type='hist', reference_name=None, comparison_names=None, title=None, return_data=False, savefig=None)</td></tr>
<tr class="memdesc:a2193b9959e668738e07d9a011e410c8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plot the lRMSDs of atomic positions between the molecules in <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> sets compared to a reference set.  <a href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a2193b9959e668738e07d9a011e410c8b">More...</a><br /></td></tr>
<tr class="separator:a2193b9959e668738e07d9a011e410c8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebc83fa09f59eecea96e6c32ec611b02"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#aebc83fa09f59eecea96e6c32ec611b02">plot_bond_length_difference</a> (self, reference, comparisons, plot_type='hist', reference_name=None, comparison_names=None, title=None, return_data=False, savefig=None, kde_bw_minmax=[-1.0, 1.0])</td></tr>
<tr class="memdesc:aebc83fa09f59eecea96e6c32ec611b02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plot the mean differences in bond lengths between the molecules in <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> sets compared to a reference set.  <a href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#aebc83fa09f59eecea96e6c32ec611b02">More...</a><br /></td></tr>
<tr class="separator:aebc83fa09f59eecea96e6c32ec611b02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a389811818193feaeae4971730e4890c5"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a389811818193feaeae4971730e4890c5">plot_force_difference</a> (self, reference, comparisons, plot_type='hist', reference_name=None, comparison_names=None, title=None, return_data=False, savefig=None)</td></tr>
<tr class="memdesc:a389811818193feaeae4971730e4890c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plot the RMSDs of atomic forces between the molecules in <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> sets compared to a reference set.  <a href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a389811818193feaeae4971730e4890c5">More...</a><br /></td></tr>
<tr class="separator:a389811818193feaeae4971730e4890c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa511144de588c1f1b3b3c8b66aeea81b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#aa511144de588c1f1b3b3c8b66aeea81b">plot_energy_difference</a> (self, reference_set, comparison_sets, plot_type='hist', reference_name=None, comparison_names=None, title=None, return_data=False, savefig=None)</td></tr>
<tr class="memdesc:aa511144de588c1f1b3b3c8b66aeea81b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plot the energy differences between identically structured molecules in <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> sets compared to a reference set.  <a href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#aa511144de588c1f1b3b3c8b66aeea81b">More...</a><br /></td></tr>
<tr class="separator:aa511144de588c1f1b3b3c8b66aeea81b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a1abf06bd44f595f62f28a946547157b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a1abf06bd44f595f62f28a946547157b0">skl_kde_samples</a></td></tr>
<tr class="separator:a1abf06bd44f595f62f28a946547157b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a5a3e24f866b66faca3cb57c0bc1b9234"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a5a3e24f866b66faca3cb57c0bc1b9234">_compare_positions</a> (self, arl1, arl2, ignore_H=False)</td></tr>
<tr class="memdesc:a5a3e24f866b66faca3cb57c0bc1b9234"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the (least)RMSDs of atomic positions between the molecules in two <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> sets.  <a href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a5a3e24f866b66faca3cb57c0bc1b9234">More...</a><br /></td></tr>
<tr class="separator:a5a3e24f866b66faca3cb57c0bc1b9234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2153faca8410c0904855ad890dca9477"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a2153faca8410c0904855ad890dca9477">_compare_bond_lengths</a> (self, arl1, arl2)</td></tr>
<tr class="memdesc:a2153faca8410c0904855ad890dca9477"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the mean differences in bond lengths between the molecules in two <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> sets.  <a href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a2153faca8410c0904855ad890dca9477">More...</a><br /></td></tr>
<tr class="separator:a2153faca8410c0904855ad890dca9477"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fdea4dbbfe2611fb9b193d708b07073"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a5fdea4dbbfe2611fb9b193d708b07073">_compare_forces</a> (self, arl1, arl2)</td></tr>
<tr class="memdesc:a5fdea4dbbfe2611fb9b193d708b07073"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the RMSDs of atomic forces between the molecules in two <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> sets.  <a href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a5fdea4dbbfe2611fb9b193d708b07073">More...</a><br /></td></tr>
<tr class="separator:a5fdea4dbbfe2611fb9b193d708b07073"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a103d084d38614a6fd33388eeb26aedb1"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a103d084d38614a6fd33388eeb26aedb1">_compare_energies</a> (self, arl1, arl2)</td></tr>
<tr class="memdesc:a103d084d38614a6fd33388eeb26aedb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare relative energies of the molecules in two <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> sets.  <a href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a103d084d38614a6fd33388eeb26aedb1">More...</a><br /></td></tr>
<tr class="separator:a103d084d38614a6fd33388eeb26aedb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Handles analysis and plotting of comparative results. </p>
<p>Contains functions to extract a range of comparative properties from lists of AtomsRows, as well as plotting functions to combine their outputs into publication-quality graphs.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">skl_kde_samples</td><td><em><b>int</b></em> <br  />
 Number of samples to evaluate Scikit-learn KDE plots over when calculating sample means and vaiances. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="analyse_8py_source.html#l00037">37</a> of file <a class="el" href="analyse_8py_source.html">analyse.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ab31c59b13440f2e7f87ea89c54585741"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab31c59b13440f2e7f87ea89c54585741">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def DFdb.analyse.DFanalysis.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>skl_kde_samples</em> = <code>10000</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html" title="Handles analysis and plotting of comparative results.">DFanalysis</a> object. </p>

<p class="definition">Definition at line <a class="el" href="analyse_8py_source.html#l00040">40</a> of file <a class="el" href="analyse_8py_source.html">analyse.py</a>.</p>
<div class="fragment"></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a2193b9959e668738e07d9a011e410c8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2193b9959e668738e07d9a011e410c8b">&#9670;&nbsp;</a></span>plot_position_difference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def DFdb.analyse.DFanalysis.plot_position_difference </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reference</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>comparisons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ignore_H</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>plot_type</em> = <code>'hist'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reference_name</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>comparison_names</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>title</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_data</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>savefig</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Plot the lRMSDs of atomic positions between the molecules in <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> sets compared to a reference set. </p>
<p>Either uses Seaborn to produce a rough histogram or histogram+KDE plot, or uses Scikit-learn to fit an accurate KDE plot and report mean and variance of the resulting data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reference</td><td><em><b>list</b></em> <br  />
 List of AtomsRows with identical chemical formulae to those in comparison. </td></tr>
    <tr><td class="paramname">comparisons</td><td><em><b>list</b></em> <br  />
 List of comparative lists of AtomsRows with identical chemical formulae to those in reference. </td></tr>
    <tr><td class="paramname">ignore_H</td><td><em><b>boolean; Default: False</b></em> <br  />
 Whether to ignore hydrogens in the RMSD calculation. </td></tr>
    <tr><td class="paramname">plot_type</td><td><em><b>str; Default: hist; Choices: (hist, hist+kde, kde)</b></em> <br  />
 The type of plot to produce. </td></tr>
    <tr><td class="paramname">reference_name</td><td><em><b>str; Optional</b></em> <br  />
 Name of the reference dataset. </td></tr>
    <tr><td class="paramname">comparison_names</td><td><em><b>list; Optional</b></em> <br  />
 List of names of the comparison datasets. </td></tr>
    <tr><td class="paramname">title</td><td><em><b>str; Optional</b></em> <br  />
 Figure title for the graph. </td></tr>
    <tr><td class="paramname">return_data</td><td><em><b>boolean; Default: False</b></em> <br  />
 Whether to include a DataFrame of all the lRMSD data used in plotting. </td></tr>
    <tr><td class="paramname">savefig</td><td><em><b>str or None; Optional</b></em> <br  />
 Whether to save the figure to file. Leaving as None means no saving, otherwise a string containing the path to save to should be passed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If the Scikit-learn implementation is used, the first return value is a Pandas DataFrame containing the accurate results from the KDE fit. Otherwise, this value returns None. If return_data is True then the second return value is a Pandas DataFrame of all the position lRMSDs, otherwise this value returns None. </dd></dl>

<p class="definition">Definition at line <a class="el" href="analyse_8py_source.html#l00080">80</a> of file <a class="el" href="analyse_8py_source.html">analyse.py</a>.</p>
<div class="fragment"></div><!-- fragment -->
<p class="reference">References <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a5a3e24f866b66faca3cb57c0bc1b9234">DFdb.analyse.DFanalysis._compare_positions()</a>, and <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a1abf06bd44f595f62f28a946547157b0">DFdb.analyse.DFanalysis.skl_kde_samples</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_d_fdb_1_1analyse_1_1_d_fanalysis_a2193b9959e668738e07d9a011e410c8b_cgraph.png" border="0" usemap="#aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a2193b9959e668738e07d9a011e410c8b_cgraph" alt=""/></div>
<map name="aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a2193b9959e668738e07d9a011e410c8b_cgraph" id="aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a2193b9959e668738e07d9a011e410c8b_cgraph">
<area shape="rect" title="Plot the lRMSDs of atomic positions between the molecules in DFdb sets compared to a reference set." alt="" coords="5,5,196,47"/>
<area shape="rect" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a5a3e24f866b66faca3cb57c0bc1b9234" title="Calculate the (least)RMSDs of atomic positions between the molecules in two DFdb sets." alt="" coords="244,5,415,47"/>
</map>
</div>

</div>
</div>
<a id="a5a3e24f866b66faca3cb57c0bc1b9234"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a3e24f866b66faca3cb57c0bc1b9234">&#9670;&nbsp;</a></span>_compare_positions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def DFdb.analyse.DFanalysis._compare_positions </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arl1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arl2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ignore_H</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the (least)RMSDs of atomic positions between the molecules in two <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> sets. </p>
<p>The molecules in each of the sets should be calculated from the same structure files to ensure identical atomic mapping.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arl1</td><td><em><b>list</b></em> <br  />
 List of AtomsRows containing a set of AtomsRows with identical chemical formulae to those in ari2. </td></tr>
    <tr><td class="paramname">arl2</td><td><em><b>list</b></em> <br  />
 List of AtomsRows containing a set of AtomsRows with identical chemical formulae to those in ari1. </td></tr>
    <tr><td class="paramname">ignore_H</td><td><em><b>boolean; Default: False</b></em> <br  />
 Whether to ignore hydrogens in the RMSD calculation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A list of lRMSDs with a value for each pair of rows in arl1 and arl2. </dd></dl>

<p class="definition">Definition at line <a class="el" href="analyse_8py_source.html#l00217">217</a> of file <a class="el" href="analyse_8py_source.html">analyse.py</a>.</p>
<div class="fragment"></div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a2193b9959e668738e07d9a011e410c8b">DFdb.analyse.DFanalysis.plot_position_difference()</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_d_fdb_1_1analyse_1_1_d_fanalysis_a5a3e24f866b66faca3cb57c0bc1b9234_icgraph.png" border="0" usemap="#aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a5a3e24f866b66faca3cb57c0bc1b9234_icgraph" alt=""/></div>
<map name="aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a5a3e24f866b66faca3cb57c0bc1b9234_icgraph" id="aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a5a3e24f866b66faca3cb57c0bc1b9234_icgraph">
<area shape="rect" title="Calculate the (least)RMSDs of atomic positions between the molecules in two DFdb sets." alt="" coords="244,5,415,47"/>
<area shape="rect" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a2193b9959e668738e07d9a011e410c8b" title="Plot the lRMSDs of atomic positions between the molecules in DFdb sets compared to a reference set." alt="" coords="5,5,196,47"/>
</map>
</div>

</div>
</div>
<a id="aebc83fa09f59eecea96e6c32ec611b02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebc83fa09f59eecea96e6c32ec611b02">&#9670;&nbsp;</a></span>plot_bond_length_difference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def DFdb.analyse.DFanalysis.plot_bond_length_difference </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reference</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>comparisons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>plot_type</em> = <code>'hist'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reference_name</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>comparison_names</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>title</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_data</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>savefig</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kde_bw_minmax</em> = <code>[-1.0,&#160;1.0]</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Plot the mean differences in bond lengths between the molecules in <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> sets compared to a reference set. </p>
<p>Either uses Seaborn to produce a rough histogram or histogram+KDE plot, or uses Scikit-learn to fit an accurate KDE plot and report mean and variance of the resulting data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reference</td><td><em><b>list</b></em> <br  />
 List of AtomsRows with identical chemical formulae to those in comparison. </td></tr>
    <tr><td class="paramname">comparisons</td><td><em><b>list</b></em> <br  />
 List of comparative lists of AtomsRows with identical chemical formulae to those in reference. </td></tr>
    <tr><td class="paramname">plot_type</td><td><em><b>str; Default: hist; Choices: (hist, hist+kde, kde)</b></em> <br  />
 The type of plot to produce. </td></tr>
    <tr><td class="paramname">reference_name</td><td><em><b>str; Optional</b></em> <br  />
 Name of the reference dataset. </td></tr>
    <tr><td class="paramname">comparison_names</td><td><em><b>list; Optional</b></em> <br  />
 List of names of the comparison datasets. </td></tr>
    <tr><td class="paramname">title</td><td><em><b>str; Optional</b></em> <br  />
 Figure title for the graph. </td></tr>
    <tr><td class="paramname">return_data</td><td><em><b>boolean; Default: False</b></em> <br  />
 Whether to include a DataFrame of all the RMSD data used in plotting. </td></tr>
    <tr><td class="paramname">savefig</td><td><em><b>str or None; Optional</b></em> <br  />
 Whether to save the figure to file. Leaving as None means no saving, otherwise a string containing the path to save to should be passed. </td></tr>
    <tr><td class="paramname">kde_bw_minmax</td><td><em><b>list; Default: [-1.0, 1.0]</b></em> <br  />
 The minimum/maximum KDE bandwidths to search over when evaluating an accurate KDE (plot_type='kde'). Should be laid out as [min, max]. These values are passed into numpy.logspace(), so they should be interpreted as 10^min and 10^max. This option is included here as a failsafe if the optimised bandwith is clearly being evaluated to be too low (overfitting of data).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If the Scikit-learn implementation is used, the first return value is a Pandas DataFrame containing the accurate results from the KDE fit. Otherwise, this value returns None. If return_data is True then the second return value is a Pandas DataFrame of all the mean bond length differences, otherwise this value returns None. </dd></dl>

<p class="definition">Definition at line <a class="el" href="analyse_8py_source.html#l00298">298</a> of file <a class="el" href="analyse_8py_source.html">analyse.py</a>.</p>
<div class="fragment"></div><!-- fragment -->
<p class="reference">References <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a2153faca8410c0904855ad890dca9477">DFdb.analyse.DFanalysis._compare_bond_lengths()</a>, and <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a1abf06bd44f595f62f28a946547157b0">DFdb.analyse.DFanalysis.skl_kde_samples</a>.</p>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_d_fdb_1_1analyse_1_1_d_fanalysis_aebc83fa09f59eecea96e6c32ec611b02_cgraph.png" border="0" usemap="#aclass_d_fdb_1_1analyse_1_1_d_fanalysis_aebc83fa09f59eecea96e6c32ec611b02_cgraph" alt=""/></div>
<map name="aclass_d_fdb_1_1analyse_1_1_d_fanalysis_aebc83fa09f59eecea96e6c32ec611b02_cgraph" id="aclass_d_fdb_1_1analyse_1_1_d_fanalysis_aebc83fa09f59eecea96e6c32ec611b02_cgraph">
<area shape="rect" title="Plot the mean differences in bond lengths between the molecules in DFdb sets compared to a reference ..." alt="" coords="5,5,196,47"/>
<area shape="rect" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a2153faca8410c0904855ad890dca9477" title="Calculate the mean differences in bond lengths between the molecules in two DFdb sets." alt="" coords="244,5,415,47"/>
</map>
</div>

</div>
</div>
<a id="a2153faca8410c0904855ad890dca9477"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2153faca8410c0904855ad890dca9477">&#9670;&nbsp;</a></span>_compare_bond_lengths()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def DFdb.analyse.DFanalysis._compare_bond_lengths </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arl1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arl2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the mean differences in bond lengths between the molecules in two <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> sets. </p>
<p>The molecules in each of the sets should be calculated from the same structure files to ensure identical atomic mapping.</p>
<p>Separates out bond length differences by bond type, providing alist of bond length differences for each unique bond type encountered in the molecules.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arl1</td><td><em><b>list</b></em> <br  />
 List of AtomsRows containing a set of AtomsRows with identical chemical formulae to those in ari2. </td></tr>
    <tr><td class="paramname">arl2</td><td><em><b>list</b></em> <br  />
 List of AtomsRows containing a set of AtomsRows with identical chemical formulae to those in ari1.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A list of bond length differences with a value for each pair of rows in arl1 and arl2, alongside a list of corresponding bond type descriptors (eg. 'C-H'). </dd></dl>

<p class="definition">Definition at line <a class="el" href="analyse_8py_source.html#l00479">479</a> of file <a class="el" href="analyse_8py_source.html">analyse.py</a>.</p>
<div class="fragment"></div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#aebc83fa09f59eecea96e6c32ec611b02">DFdb.analyse.DFanalysis.plot_bond_length_difference()</a>.</p>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_d_fdb_1_1analyse_1_1_d_fanalysis_a2153faca8410c0904855ad890dca9477_icgraph.png" border="0" usemap="#aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a2153faca8410c0904855ad890dca9477_icgraph" alt=""/></div>
<map name="aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a2153faca8410c0904855ad890dca9477_icgraph" id="aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a2153faca8410c0904855ad890dca9477_icgraph">
<area shape="rect" title="Calculate the mean differences in bond lengths between the molecules in two DFdb sets." alt="" coords="244,5,415,47"/>
<area shape="rect" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#aebc83fa09f59eecea96e6c32ec611b02" title="Plot the mean differences in bond lengths between the molecules in DFdb sets compared to a reference ..." alt="" coords="5,5,196,47"/>
</map>
</div>

</div>
</div>
<a id="a389811818193feaeae4971730e4890c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a389811818193feaeae4971730e4890c5">&#9670;&nbsp;</a></span>plot_force_difference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def DFdb.analyse.DFanalysis.plot_force_difference </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reference</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>comparisons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>plot_type</em> = <code>'hist'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reference_name</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>comparison_names</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>title</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_data</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>savefig</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Plot the RMSDs of atomic forces between the molecules in <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> sets compared to a reference set. </p>
<p>Either uses Seaborn to produce a rough histogram or histogram+KDE plot, or uses Scikit-learn to fit an accurate KDE plot and report mean and variance of the resulting data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reference</td><td><em><b>list</b></em> <br  />
 List of AtomsRows with identical chemical formulae to those in comparison. </td></tr>
    <tr><td class="paramname">comparisons</td><td><em><b>list</b></em> <br  />
 List of comparative lists of AtomsRows with identical chemical formulae to those in reference. </td></tr>
    <tr><td class="paramname">plot_type</td><td><em><b>str; Default: hist; Choices: (hist, hist+kde, kde)</b></em> <br  />
 The type of plot to produce. </td></tr>
    <tr><td class="paramname">reference_name</td><td><em><b>str; Optional</b></em> <br  />
 Name of the reference dataset. </td></tr>
    <tr><td class="paramname">comparison_names</td><td><em><b>list; Optional</b></em> <br  />
 List of names of the comparison datasets. </td></tr>
    <tr><td class="paramname">title</td><td><em><b>str; Optional</b></em> <br  />
 Figure title for the graph. </td></tr>
    <tr><td class="paramname">return_data</td><td><em><b>boolean; Default: False</b></em> <br  />
 Whether to include a DataFrame of all the RMSD data used in plotting. </td></tr>
    <tr><td class="paramname">savefig</td><td><em><b>str or None; Optional</b></em> <br  />
 Whether to save the figure to file. Leaving as None means no saving, otherwise a string containing the path to save to should be passed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If the Scikit-learn implementation is used, the first return value is a Pandas DataFrame containing the accurate results from the KDE fit. Otherwise, this value returns None. If return_data is True then the second return value is a Pandas DataFrame of all the force RMSDs, otherwise this value returns None. </dd></dl>

<p class="definition">Definition at line <a class="el" href="analyse_8py_source.html#l00594">594</a> of file <a class="el" href="analyse_8py_source.html">analyse.py</a>.</p>
<div class="fragment"></div><!-- fragment -->
<p class="reference">References <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a5fdea4dbbfe2611fb9b193d708b07073">DFdb.analyse.DFanalysis._compare_forces()</a>, and <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a1abf06bd44f595f62f28a946547157b0">DFdb.analyse.DFanalysis.skl_kde_samples</a>.</p>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_d_fdb_1_1analyse_1_1_d_fanalysis_a389811818193feaeae4971730e4890c5_cgraph.png" border="0" usemap="#aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a389811818193feaeae4971730e4890c5_cgraph" alt=""/></div>
<map name="aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a389811818193feaeae4971730e4890c5_cgraph" id="aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a389811818193feaeae4971730e4890c5_cgraph">
<area shape="rect" title="Plot the RMSDs of atomic forces between the molecules in DFdb sets compared to a reference set." alt="" coords="5,5,196,47"/>
<area shape="rect" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a5fdea4dbbfe2611fb9b193d708b07073" title="Calculate the RMSDs of atomic forces between the molecules in two DFdb sets." alt="" coords="244,5,415,47"/>
</map>
</div>

</div>
</div>
<a id="a5fdea4dbbfe2611fb9b193d708b07073"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fdea4dbbfe2611fb9b193d708b07073">&#9670;&nbsp;</a></span>_compare_forces()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def DFdb.analyse.DFanalysis._compare_forces </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arl1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arl2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the RMSDs of atomic forces between the molecules in two <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> sets. </p>
<p>The molecules in each of the sets should be calculated from the same structure files to ensure identical atomic mapping.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arl1</td><td><em><b>list</b></em> <br  />
 List of AtomsRows containing a set of AtomsRows with identical chemical formulae to those in ari2. </td></tr>
    <tr><td class="paramname">arl2</td><td><em><b>list</b></em> <br  />
 List of AtomsRows containing a set of AtomsRows with identical chemical formulae to those in ari1.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A list of RMSDs with a value for each pair of rows in arl1 and arl2. </dd></dl>

<p class="definition">Definition at line <a class="el" href="analyse_8py_source.html#l00726">726</a> of file <a class="el" href="analyse_8py_source.html">analyse.py</a>.</p>
<div class="fragment"></div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a389811818193feaeae4971730e4890c5">DFdb.analyse.DFanalysis.plot_force_difference()</a>.</p>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_d_fdb_1_1analyse_1_1_d_fanalysis_a5fdea4dbbfe2611fb9b193d708b07073_icgraph.png" border="0" usemap="#aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a5fdea4dbbfe2611fb9b193d708b07073_icgraph" alt=""/></div>
<map name="aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a5fdea4dbbfe2611fb9b193d708b07073_icgraph" id="aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a5fdea4dbbfe2611fb9b193d708b07073_icgraph">
<area shape="rect" title="Calculate the RMSDs of atomic forces between the molecules in two DFdb sets." alt="" coords="244,5,415,47"/>
<area shape="rect" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a389811818193feaeae4971730e4890c5" title="Plot the RMSDs of atomic forces between the molecules in DFdb sets compared to a reference set." alt="" coords="5,5,196,47"/>
</map>
</div>

</div>
</div>
<a id="aa511144de588c1f1b3b3c8b66aeea81b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa511144de588c1f1b3b3c8b66aeea81b">&#9670;&nbsp;</a></span>plot_energy_difference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def DFdb.analyse.DFanalysis.plot_energy_difference </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reference_set</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>comparison_sets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>plot_type</em> = <code>'hist'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reference_name</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>comparison_names</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>title</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_data</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>savefig</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Plot the energy differences between identically structured molecules in <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> sets compared to a reference set. </p>
<p>Either uses Seaborn to produce a rough histogram or histogram+KDE plot, or uses Scikit-learn to fit an accurate KDE plot and report mean and variance of the resulting data.</p>
<p>Each unique struct_name in a <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> set must be accompanied by a corresponding energy reference, placed first in that set's list. For example, if there are 4 types of struct_name forming 4 sub-lists in 'reference_set', the first molecule of each sub-list should be a reference structure which all other energies will be compared against, eg. an optimised ground state structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reference_set</td><td><em><b>list</b></em> <br  />
 List of lists of AtomsRows, separated by struct_names. The first entry of each sub-list should be a reliable energy reference. </td></tr>
    <tr><td class="paramname">comparison_sets</td><td><em><b>list</b></em> <br  />
 List of comparative lists of AtomsRows, with sub-lists separated by struct_names. The first entry of each sub-list should be a reliable energy reference. </td></tr>
    <tr><td class="paramname">plot_type</td><td><em><b>str; Default: hist; Choices: (hist, hist+kde, kde)</b></em> <br  />
 The type of plot to produce. </td></tr>
    <tr><td class="paramname">reference_name</td><td><em><b>str; Optional</b></em> <br  />
 Name of the reference dataset. </td></tr>
    <tr><td class="paramname">comparison_names</td><td><em><b>list; Optional</b></em> <br  />
 List of names of the comparison datasets. </td></tr>
    <tr><td class="paramname">title</td><td><em><b>str; Optional</b></em> <br  />
 Figure title for the graph. </td></tr>
    <tr><td class="paramname">return_data</td><td><em><b>boolean; Default: False</b></em> <br  />
 Whether to include a DataFrame of all the relative energy difference data used in </td></tr>
    <tr><td class="paramname">plotting.</td><td></td></tr>
    <tr><td class="paramname">savefig</td><td><em><b>str or None; Optional</b></em> <br  />
 Whether to save the figure to file. Leaving as None means no saving, otherwise a string containing the path to save to should be passed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If the Scikit-learn implementation is used, the first return value is a Pandas DataFrame containing the accurate results from the KDE fit. Otherwise, this value returns None. If return_data is True then the second return value is a Pandas DataFrame of all the relative energy differences, otherwise this value returns None. </dd></dl>

<p class="definition">Definition at line <a class="el" href="analyse_8py_source.html#l00793">793</a> of file <a class="el" href="analyse_8py_source.html">analyse.py</a>.</p>
<div class="fragment"></div><!-- fragment -->
<p class="reference">References <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a103d084d38614a6fd33388eeb26aedb1">DFdb.analyse.DFanalysis._compare_energies()</a>, and <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a1abf06bd44f595f62f28a946547157b0">DFdb.analyse.DFanalysis.skl_kde_samples</a>.</p>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_d_fdb_1_1analyse_1_1_d_fanalysis_aa511144de588c1f1b3b3c8b66aeea81b_cgraph.png" border="0" usemap="#aclass_d_fdb_1_1analyse_1_1_d_fanalysis_aa511144de588c1f1b3b3c8b66aeea81b_cgraph" alt=""/></div>
<map name="aclass_d_fdb_1_1analyse_1_1_d_fanalysis_aa511144de588c1f1b3b3c8b66aeea81b_cgraph" id="aclass_d_fdb_1_1analyse_1_1_d_fanalysis_aa511144de588c1f1b3b3c8b66aeea81b_cgraph">
<area shape="rect" title="Plot the energy differences between identically structured molecules in DFdb sets compared to a refer..." alt="" coords="5,5,196,47"/>
<area shape="rect" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a103d084d38614a6fd33388eeb26aedb1" title="Compare relative energies of the molecules in two DFdb sets." alt="" coords="244,5,415,47"/>
</map>
</div>

</div>
</div>
<a id="a103d084d38614a6fd33388eeb26aedb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a103d084d38614a6fd33388eeb26aedb1">&#9670;&nbsp;</a></span>_compare_energies()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def DFdb.analyse.DFanalysis._compare_energies </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arl1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arl2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compare relative energies of the molecules in two <a class="el" href="namespace_d_fdb.html" title="ASE database wrapper package for making and analysing comparative databases of molecules.">DFdb</a> sets. </p>
<p>Energies of each molecule in the sets get defined relative to a reference structure, eg. to the ground state structure, which will be read from the first AtomsRow. All molecules in each of the sets AND the reference should have the same chemical formulae.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arl1</td><td><em><b>list</b></em> <br  />
 List of AtomsRows containing a set of AtomsRows with identical chemical formulae to those in ari2. </td></tr>
    <tr><td class="paramname">arl2</td><td><em><b>list</b></em> <br  />
 List of AtomsRows containing a set of AtomsRows with identical chemical formulae to those in ari1.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A list of relative energy differences with a value for each pair of rows (excluding the first pair, since these are the reference values) in arl1 and arl2. </dd></dl>

<p class="definition">Definition at line <a class="el" href="analyse_8py_source.html#l00977">977</a> of file <a class="el" href="analyse_8py_source.html">analyse.py</a>.</p>
<div class="fragment"></div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#aa511144de588c1f1b3b3c8b66aeea81b">DFdb.analyse.DFanalysis.plot_energy_difference()</a>.</p>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_d_fdb_1_1analyse_1_1_d_fanalysis_a103d084d38614a6fd33388eeb26aedb1_icgraph.png" border="0" usemap="#aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a103d084d38614a6fd33388eeb26aedb1_icgraph" alt=""/></div>
<map name="aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a103d084d38614a6fd33388eeb26aedb1_icgraph" id="aclass_d_fdb_1_1analyse_1_1_d_fanalysis_a103d084d38614a6fd33388eeb26aedb1_icgraph">
<area shape="rect" title="Compare relative energies of the molecules in two DFdb sets." alt="" coords="244,5,415,47"/>
<area shape="rect" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#aa511144de588c1f1b3b3c8b66aeea81b" title="Plot the energy differences between identically structured molecules in DFdb sets compared to a refer..." alt="" coords="5,5,196,47"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a1abf06bd44f595f62f28a946547157b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1abf06bd44f595f62f28a946547157b0">&#9670;&nbsp;</a></span>skl_kde_samples</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DFdb.analyse.DFanalysis.skl_kde_samples</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="analyse_8py_source.html#l00041">41</a> of file <a class="el" href="analyse_8py_source.html">analyse.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#aebc83fa09f59eecea96e6c32ec611b02">DFdb.analyse.DFanalysis.plot_bond_length_difference()</a>, <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#aa511144de588c1f1b3b3c8b66aeea81b">DFdb.analyse.DFanalysis.plot_energy_difference()</a>, <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a389811818193feaeae4971730e4890c5">DFdb.analyse.DFanalysis.plot_force_difference()</a>, and <a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html#a2193b9959e668738e07d9a011e410c8b">DFdb.analyse.DFanalysis.plot_position_difference()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>repo/DFdb/<a class="el" href="analyse_8py_source.html">analyse.py</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_d_fdb.html">DFdb</a></li><li class="navelem"><a class="el" href="namespace_d_fdb_1_1analyse.html">analyse</a></li><li class="navelem"><a class="el" href="class_d_fdb_1_1analyse_1_1_d_fanalysis.html">DFanalysis</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
